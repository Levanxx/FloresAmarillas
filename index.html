<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Flores Amarillas ‚Äî Ramo</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg1:#0f1020;
      --bg2:#171a35;
      --accent:#FFD54F;     /* p√©talos */
      --accent-2:#FFC107;   /* borde p√©talo */
      --center:#8D6E63;     /* centro */
      --stem:#2e7d32;       /* tallo/hojas */
      --glow:#fff59d;
      --card:#101225cc;
      --white:#f8fafc;
      --ground:#0c0f22;
      --ribbon:#ff7a7a;     /* mo√±o */
      --paper:#f7e9b0cc;    /* papel kraft */
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:Poppins,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Helvetica,Arial,sans-serif;
      color:var(--white);
      background:
        radial-gradient(1200px 800px at 80% -20%, #2b2f7a33, transparent 60%),
        radial-gradient(900px 600px at -10% 20%, #b388ff1a, transparent 60%),
        linear-gradient(180deg,var(--bg1),var(--bg2));
      overflow:hidden;
    }

    .wrap{
      position:relative; height:100%;
      display:grid; place-items:center; padding:24px; isolation:isolate;
    }

    /* Tarjeta principal (se oculta al florecer) */
    .card{
      position:relative; max-width:min(820px, 92vw);
      padding:clamp(20px, 4vw, 36px); border-radius:24px;
      background:var(--card); backdrop-filter: blur(10px);
      box-shadow: 0 10px 30px #0006, inset 0 0 0 1px #ffffff1a;
      z-index:3; text-align:center;
      transition: opacity .35s ease, transform .35s ease, visibility .35s ease;
    }
    .card.hidden-soft{ opacity:0; transform: translateY(-6px) scale(.98); visibility:hidden }

    h1{ margin:0 0 8px; font-size:clamp(28px, 5.5vw, 52px); line-height:1.05; letter-spacing:0.2px; }
    p.sub{ margin:0 0 18px; opacity:.9; font-weight:300; font-size:clamp(15px, 2.6vw, 18px) }

    .btns{ display:flex; gap:12px; justify-content:center; flex-wrap:wrap;
      transition: opacity .35s ease, transform .35s ease, visibility .35s ease }
    .btns.hidden{ opacity:0; transform: translateY(8px) scale(.98); visibility:hidden; pointer-events:none }
    .btn{
      appearance:none; border:0; cursor:pointer; padding:12px 18px; border-radius:12px; font-weight:600;
      color:#0a0a0a; background:linear-gradient(180deg,#ffe173,#ffc400);
      box-shadow: 0 8px 20px #ffc10744, inset 0 -2px 0 #b28700;
      transition: transform .12s ease, box-shadow .12s ease;
    }
    .btn:hover{ transform: translateY(-2px) scale(1.02) }
    .btn:active{ transform: translateY(0) scale(.98) }
    .btn.secondary{ background:#1c2048; color:#e6e8ff; box-shadow: inset 0 0 0 1px #3f46a7 }

    /* Cinta superior */
    .ribbon{
      position:absolute; top:10px; right:10px; z-index:4; padding:8px 14px; border-radius:999px;
      background:#0f1130cc; backdrop-filter: blur(8px); border:1px solid #ffffff22; font-size:12px; letter-spacing:.3px;
      transition: opacity .35s ease, transform .35s ease, visibility .35s ease;
    }
    .ribbon.hidden-soft{ opacity:0; transform: translateY(-6px) scale(.98); visibility:hidden }

    /* Jard√≠n/canvas */
    .garden{ position:absolute; inset:0; z-index:1; pointer-events:none; filter: drop-shadow(0 6px 12px #0006); overflow:hidden }
    .ground{
      position:absolute; left:0; right:0; bottom:-10px; height:38%;
      background:
        radial-gradient(80% 120% at 50% 0%, #20325a40 0%, transparent 60%),
        linear-gradient(180deg, transparent 0%, #0e1230 30%, var(--ground) 100%);
      z-index:0;
    }

    /* Glows */
    .glow{ position:absolute; inset:0; z-index:0; pointer-events:none }
    .glow::before, .glow::after{
      content:""; position:absolute; border-radius:50%;
      background: radial-gradient(closest-side, #fff59d33, transparent 70%);
      animation: twinkle 6s ease-in-out infinite;
    }
    .glow::before{ width:520px; height:520px; top:10%; left:-120px; animation-delay:.8s }
    .glow::after { width:420px; height:420px; bottom:-60px; right:-60px; animation-delay:1.6s }
    @keyframes twinkle{ 0%,100%{opacity:.65; filter:blur(0)} 50%{opacity:1; filter:blur(.2px)} }

    /* SVG del ramo */
    svg.bouquet{
      position:absolute;
      filter: drop-shadow(0 6px 12px #0006);
      pointer-events:none;
    }

    /* Barra volver */
    .backbar{ position:fixed; left:50%; transform:translateX(-50%); bottom:18px; z-index:4; display:none }
    .backbar.show{ display:block }
    .backbtn{ appearance:none; border:0; cursor:pointer; padding:10px 14px; border-radius:12px;
      background:#141842; color:#e6e8ff; box-shadow: inset 0 0 0 1px #3f46a7; font-weight:600 }

    .credits{ position:fixed; inset:auto 0 10px; display:flex; justify-content:center; font-size:12px; opacity:.7 }
    .sr-only{ position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0 }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="glow" aria-hidden="true"></div>
    <div class="ribbon">üíõ Yazuri</div>

    <div class="card" id="card">
      <h1>Para ti, un jard√≠n de <span style="color:#ffe066;text-shadow:0 0 10px #ffe06655">flores amarillas</span></h1>
      <p class="sub">Porque los detalles bonitos tambi√©n se programan. Toca el bot√≥n para ‚Äúflorecer‚Äù.</p>
      <div class="btns" id="btnGroup">
        <button class="btn" id="bloomBtn">Hacer florecer ‚ú®</button>
        <button class="btn secondary" id="msgBtn" aria-controls="mensaje" aria-expanded="true">Ocultar mensaje üôà</button>
      </div>
      <p id="mensaje" class="sub" style="margin-top:14px">
        Que hoy te pase algo <b>amarillo</b>: brillante, c√°lido y lleno de buena suerte. üåª
      </p>
    </div>

    <div class="garden" id="garden" aria-hidden="true">
      <div class="ground" aria-hidden="true"></div>
    </div>

    <span class="sr-only">Ramo de flores amarillas con tallos, hojas y mo√±o.</span>
  </div>

  <div class="backbar" id="backbar">
    <button class="backbtn" id="resetBtn">Volver a los botones ‚Ü©Ô∏è</button>
  </div>

  <div class="credits">Levanx</div>

  <script>
    /* ===== refs ===== */
    const bloomBtn = document.getElementById('bloomBtn');
    const msgBtn   = document.getElementById('msgBtn');
    const msg      = document.getElementById('mensaje');
    const btnGroup = document.getElementById('btnGroup');
    const ribbon   = document.querySelector('.ribbon');
    const card     = document.getElementById('card');

    const garden   = document.getElementById('garden');
    const backbar  = document.getElementById('backbar');
    const resetBtn = document.getElementById('resetBtn');

    let blooming = false;
    let resizeTimer = null;

    /* ===== helpers ===== */
    function showMessage(open){
      msg.style.display = open ? 'block' : 'none';
      msgBtn.setAttribute('aria-expanded', String(open));
      msgBtn.textContent = open ? 'Ocultar mensaje üôà' : 'Mostrar mensaje üí¨';
    }
    function clearFlowers(){
      garden.querySelectorAll('svg.bouquet').forEach(el => el.remove());
    }

    /* ===== bouquet =====
       Ramo en un solo SVG con clip-path para mantener verdes dentro del papel
    =============================================== */
    function createBouquet(count = 18){
      const width  = garden.clientWidth;
      const height = garden.clientHeight;
      const groundTop = height * 0.62;

      // Lienzo del ramo (un solo SVG centrado)
      const stageW = Math.min(520, width * 0.85);
      const stageH = 420;
      const centerX = Math.round(width/2);

      const svg = document.createElementNS('http://www.w3.org/2000/svg','svg');
      svg.classList.add('bouquet');
      svg.setAttribute('viewBox', '0 0 520 420');
      svg.style.left = (centerX - stageW/2) + 'px';
      svg.style.top  = (groundTop - 240) + 'px';
      svg.style.width  = stageW + 'px';
      svg.style.height = stageH + 'px';

      // ===== defs: clip del papel (cono)
      const defs = document.createElementNS('http://www.w3.org/2000/svg','defs');

      // Cono del papel (mismo shape para clip y para dibujarlo)
      const conePathD = 'M90,36 L430,36 L354,400 L166,400 Z';
      const clip = document.createElementNS('http://www.w3.org/2000/svg','clipPath');
      clip.setAttribute('id','coneClip');
      const coneShape = document.createElementNS('http://www.w3.org/2000/svg','path');
      coneShape.setAttribute('d', conePathD);
      clip.appendChild(coneShape);

      defs.appendChild(clip);
      svg.appendChild(defs);

      // ===== capas
      const gGreens = document.createElementNS('http://www.w3.org/2000/svg','g');
      gGreens.setAttribute('clip-path','url(#coneClip)');

      const gPaper  = document.createElementNS('http://www.w3.org/2000/svg','g');
      const gHeads  = document.createElementNS('http://www.w3.org/2000/svg','g');

      // ===== distribuci√≥n horizontal de flores
      const baseY = 380;                 // ‚Äúsuelo‚Äù dentro del SVG
      const clusterW = 360;              // ancho del bouquet
      const leftX  = 80 + (520 - clusterW)/2;
      const rightX = 520 - leftX;

      for(let i=0;i<count;i++){
        const t = (i + 0.5)/count;                 // 0..1
        const spread = Math.sin(Math.PI*t) ** 0.85; // m√°s denso al centro
        const jitter = (Math.random()*2-1) * 0.07;  // leve aleatorio
        const x = leftX + ( (spread + jitter) * (rightX - leftX) );

        const stemH = 150 + Math.random()*80; // 150‚Äì230
        const scale = 0.9 + Math.random()*0.45;
        const rot   = (Math.random()*10 - 5);

        // === Verdes (tallo + hojas) DENTRO del clip
        const gGreen = document.createElementNS('http://www.w3.org/2000/svg','g');
        gGreen.setAttribute('transform', `translate(${x}, ${baseY}) rotate(${rot}) scale(${scale})`);

        const stem = document.createElementNS('http://www.w3.org/2000/svg','rect');
        stem.setAttribute('x','-3'); stem.setAttribute('y', String(-stemH));
        stem.setAttribute('width','6'); stem.setAttribute('height', String(stemH));
        stem.setAttribute('rx','3'); stem.setAttribute('fill','var(--stem)');

        const leaf1 = document.createElementNS('http://www.w3.org/2000/svg','path');
        leaf1.setAttribute('d', `M-3,${-stemH*0.52} C-38,${-stemH*0.66} -50,${-stemH*0.36} -6,${-stemH*0.42} Z`);
        leaf1.setAttribute('fill','var(--stem)'); leaf1.setAttribute('opacity','.9');

        const leaf2 = document.createElementNS('http://www.w3.org/2000/svg','path');
        leaf2.setAttribute('d', `M3,${-stemH*0.30} C36,${-stemH*0.42} 50,${-stemH*0.18} 6,${-stemH*0.22} Z`);
        leaf2.setAttribute('fill','var(--stem)'); leaf2.setAttribute('opacity','.85');

        gGreen.appendChild(stem); gGreen.appendChild(leaf1); gGreen.appendChild(leaf2);
        gGreens.appendChild(gGreen);

        // === Cabeza de flor (SIN clip, por encima del papel)
        const gHead = document.createElementNS('http://www.w3.org/2000/svg','g');
        gHead.setAttribute('transform', `translate(${x}, ${baseY - stemH - 14}) rotate(${rot}) scale(${scale})`);

        // p√©talo base
        const petalo = document.createElementNS('http://www.w3.org/2000/svg','path');
        petalo.setAttribute('id', `petalo_${i}`);
        petalo.setAttribute('d','M0,-60 C12,-50 12,-20 0,0 C-12,-20 -12,-50 0,-60Z');

        // gradiente propio (evita colisi√≥n de IDs)
        const grad = document.createElementNS('http://www.w3.org/2000/svg','radialGradient');
        const gradId = 'gradPetalo_' + Math.random().toString(36).slice(2,8);
        grad.setAttribute('id', gradId);
        grad.setAttribute('cx','50%'); grad.setAttribute('cy','30%'); grad.setAttribute('r','70%');
        [['0%','#fff59d'],['45%','var(--accent)'],['100%','#e6ac00']].forEach(([o,c])=>{
          const s = document.createElementNS('http://www.w3.org/2000/svg','stop');
          s.setAttribute('offset',o); s.setAttribute('stop-color',c); grad.appendChild(s);
        });
        defs.appendChild(grad);

        const ring = document.createElementNS('http://www.w3.org/2000/svg','g');
        ring.setAttribute('fill', `url(#${gradId})`);
        ring.setAttribute('stroke','var(--accent-2)');
        ring.setAttribute('stroke-width','1.5');
        for(let a=0;a<360;a+=30){
          const u = document.createElementNS('http://www.w3.org/2000/svg','use');
          u.setAttributeNS('http://www.w3.org/1999/xlink','href', `#${petalo.id}`);
          u.setAttribute('transform',`rotate(${a})`);
          ring.appendChild(u);
        }
        gHead.appendChild(petalo);
        gHead.appendChild(ring);

        // centro + brillo
        const c1 = document.createElementNS('http://www.w3.org/2000/svg','circle');
        c1.setAttribute('r','16'); c1.setAttribute('cy','-22');
        c1.setAttribute('fill','var(--center)'); c1.setAttribute('stroke','#5d4037'); c1.setAttribute('stroke-width','2');
        const c2 = document.createElementNS('http://www.w3.org/2000/svg','circle');
        c2.setAttribute('r','10'); c2.setAttribute('cy','-22');
        c2.setAttribute('fill','#6d4c41'); c2.setAttribute('opacity','.35');
        const glow = document.createElementNS('http://www.w3.org/2000/svg','circle');
        glow.setAttribute('r','4'); glow.setAttribute('cx','8'); glow.setAttribute('cy','-28');
        glow.setAttribute('fill','var(--glow)'); glow.setAttribute('opacity','.9');

        gHead.appendChild(c1); gHead.appendChild(c2); gHead.appendChild(glow);
        gHeads.appendChild(gHead);

        // balanceo
        const swayDur = 4800 + Math.random()*2200;
        gHead.animate(
          [
            { transform:`translate(${x}px, ${baseY - stemH - 14}px) rotate(${rot-2}deg) scale(${scale})` },
            { transform:`translate(${x}px, ${baseY - stemH - 24}px) rotate(${rot+2}deg) scale(${scale})` },
            { transform:`translate(${x}px, ${baseY - stemH - 14}px) rotate(${rot-2}deg) scale(${scale})` }
          ],
          { duration: swayDur, iterations: Infinity, easing:'ease-in-out', delay: 400 + i*40 }
        );
      }

      // ===== papel (entre verdes y cabezas)
      const paper = document.createElementNS('http://www.w3.org/2000/svg','path');
      paper.setAttribute('d', conePathD);
      paper.setAttribute('fill','var(--paper)');
      paper.setAttribute('stroke','#e7d997'); paper.setAttribute('stroke-width','2');
      paper.setAttribute('opacity','0.9');
      gPaper.appendChild(paper);

      // ===== cinta
      const band = document.createElementNS('http://www.w3.org/2000/svg','rect');
      band.setAttribute('x','180'); band.setAttribute('y','250');
      band.setAttribute('width','160'); band.setAttribute('height','22'); band.setAttribute('rx','11');
      band.setAttribute('fill','var(--ribbon)');

      const bowL = document.createElementNS('http://www.w3.org/2000/svg','path');
      bowL.setAttribute('d','M210,262 C190,236 180,236 175,262 C180,282 195,282 210,262 Z');
      bowL.setAttribute('fill','var(--ribbon)');
      const bowR = document.createElementNS('http://www.w3.org/2000/svg','path');
      bowR.setAttribute('d','M290,262 C310,236 320,236 325,262 C320,282 305,282 290,262 Z');
      bowR.setAttribute('fill','var(--ribbon)');
      const knot = document.createElementNS('http://www.w3.org/2000/svg','circle');
      knot.setAttribute('cx','260'); knot.setAttribute('cy','262'); knot.setAttribute('r','10');
      knot.setAttribute('fill','#ff6868');

      const tail1 = document.createElementNS('http://www.w3.org/2000/svg','path');
      tail1.setAttribute('d','M250,272 L238,310 L258,290 Z');
      tail1.setAttribute('fill','var(--ribbon)');
      const tail2 = document.createElementNS('http://www.w3.org/2000/svg','path');
      tail2.setAttribute('d','M270,272 L282,310 L262,290 Z');
      tail2.setAttribute('fill','var(--ribbon)');

      // ===== orden de capas dentro del SVG
      svg.appendChild(gGreens);   // 1) verdes recortados al cono
      svg.appendChild(gPaper);    // 2) papel
      svg.appendChild(band);      // 3) banda
      svg.appendChild(bowL); svg.appendChild(bowR); svg.appendChild(knot);
      svg.appendChild(tail1); svg.appendChild(tail2);
      svg.appendChild(gHeads);    // 4) cabezas por encima

      garden.appendChild(svg);

      // peque√±a entrada del conjunto
      svg.animate([{opacity:0, transform:'translateY(20px)'},{opacity:1, transform:'translateY(0)'}],
        {duration:600, easing:'ease-out', fill:'forwards'});
    }

    /* ===== control ===== */
    function setBloom(open){
      if(open){
        // ocultar todo lo ‚Äúflotante‚Äù
        document.getElementById('btnGroup').classList.add('hidden');
        document.querySelector('.ribbon').classList.add('hidden-soft');
        document.getElementById('card').classList.add('hidden-soft');
        backbar.classList.add('show');
        clearFlowers();
        createBouquet(18); // ramo
      }else{
        clearFlowers();
        document.getElementById('btnGroup').classList.remove('hidden');
        document.querySelector('.ribbon').classList.remove('hidden-soft');
        document.getElementById('card').classList.remove('hidden-soft');
        backbar.classList.remove('show');
        showMessage(true);
      }
      blooming = open;
      bloomBtn.textContent = blooming ? 'Cerrar p√©talos üåô' : 'Hacer florecer ‚ú®';
    }

    /* ===== events ===== */
    bloomBtn.addEventListener('click', ()=> setBloom(!blooming));
    resetBtn.addEventListener('click', ()=> setBloom(false));

    msgBtn.addEventListener('click', ()=>{
      const open = msg.style.display === 'none';
      showMessage(open);
    });

    // si cambia tama√±o, rearmar el ramo
    window.addEventListener('resize', ()=>{
      if(!blooming) return;
      clearTimeout(resizeTimer);
      resizeTimer = setTimeout(()=>{ clearFlowers(); createBouquet(18); }, 120);
    });

    // inicio
    window.addEventListener('load', ()=> showMessage(true));
  </script>
</body>
</html>
